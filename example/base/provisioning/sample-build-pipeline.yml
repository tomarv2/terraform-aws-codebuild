version: 0.2
environment_variables:
 plaintext:
  BUILD_ENV: "demo"
  SAS_TOKEN: $SAS_TOKEN
  STORAGE_ACCOUNT_NAME: $STORAGE_ACCOUNT_NAME
  CONTAINER_NAME: $CONTAINER_NAME
phases:
  install:
    commands:
      - pip install -r infrastructure/terraform/cicd/support/cicd/requirements.txt
  build:
    commands:
      # DEPLOY POLICIES
      - python infrastructure/terraform/cicd/support/cicd/upload_blob_using_sas.py policies/compliance/$BUILD_ENV $STORAGE_ACCOUNT_NAME $CONTAINER_NAME
